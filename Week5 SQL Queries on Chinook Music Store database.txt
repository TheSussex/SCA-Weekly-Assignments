1. Which city has the best customers?

SELECT BillingCity, MAX(Total) 
FROM invoice;



2. Which countries have the most Invoices?

SELECT BillingCountry, COUNT(Total)
FROM invoice
GROUP BY BillingCountry
ORDER BY 2 DESC
LIMIT 1;       			
	

3. Who is the best customer?

SELECT FirstName, LastName, SUM(Total)
FROM invoice
JOIN customer
ON invoice.CustomerId=customer.CustomerId
GROUP BY 2
ORDER BY 3 DESC
LIMIT 1;



4. Customers who listen to rock music

SELECT DISTINCT FirstName, LastName, Email, Genre.Name
FROM Customer
JOIN Invoice ON Customer.CustomerId=Invoice.CustomerId
JOIN InvoiceLine ON InvoiceLine.InvoiceId=Invoice.InvoiceId
JOIN Track ON Track.TrackId=InvoiceLine.TrackId
JOIN Genre ON Track.GenreId=Genre.GenreId
WHERE Genre.Name='Rock'
ORDER BY 3;



5. Most popular music genre for each country

SELECT BillingCountry, Genre, MAX(Sum_Unitprice) AS MostPopular FROM
(SELECT BillingCountry, SUM(InvoiceLine.UnitPrice) AS Sum_Unitprice, Genre.Name AS Genre
FROM Customer
JOIN Invoice ON Customer.CustomerId=Invoice.CustomerId
JOIN InvoiceLine ON InvoiceLine.InvoiceId=Invoice.InvoiceId
JOIN Track ON Track.TrackId=InvoiceLine.TrackId
JOIN Genre ON Track.GenreId=Genre.GenreId
GROUP BY 1, 3)
GROUP BY 1
ORDER BY 3; 
